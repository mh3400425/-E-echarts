# E-echarts  
>易语言模块（开源）

### 模块简介
本模块封装百度echarts.js（开源），相对于chart.js好处具有更全面api文档支持，更多的图形样式及配置支持，例如：**散点图、折线图、柱状图、饼图、地图、雷达图、K线图、箱线图、热力图、关系图、矩形树图、平行坐标、桑基图、漏斗图、仪表盘**等等。  

官方图形样例展示：http://echarts.baidu.com/examples.html  
官方API文档：http://echarts.baidu.com/option.html  



### 模块特点：

>下边除了第一行，后边的都是echarts.js的特点，本模块仅是最大限度还原保留了它的特点。

* 使用本模块前请花3分钟学习一下json文件格式基础
* 简单三行代码即可快速生成图表
* echarts.js源码已更新至最新版，且内置到模块中，所以支持离线使用
* 支持WKE浏览框控件或超文本浏览框控件（建议使用wke，可使用更好的性能和兼容性，并支持运行js代码）
* 支持使用js动态加载数据（实时动态加载显示，无需刷新整个页面，比如CPU使用率曲线功能）
* 支持单页面显示多个图表互不干扰，分别js动态加载数据
* 模块支持引入外部js或者css文件
* 模块并不封装直接生成除折线图外其他图形的功能，一切需使用模块内置json类来生成自己所需的json配置（虽稍稍提高了使用门槛，但最大限度保留了原图表库的自由性和强大功能）
* 本模块内部封装了一个简单好用的json操作类，但不强制使用，使用者可以使用任意自己熟悉的方式来生成或操作配置json

### 模块使用演示1（不使用js）
>     .版本 2
> 
>     .局部变量 json, eCharts_JSON类
>     json.解析 (标准配置_折线图 (“折线图主标题”, “折线图副标题”, X轴内容组, Y轴内容组))
>     页面代码 ＝ 页面代码_生成 (#CSS_隐藏滚动条, 创建图形 (“640px”, “480px”, , “myChart”, json.取代码 ()))  
>     
>     写到文件 (取运行目录 () ＋ “\demo.html”, 编码转换_Ansi到Utf8 (页面代码))
>     浏览框EX1.地址 ＝ 取运行目录 () ＋ “\demo.html”  
>
> 注：  
> 变量‘X轴内容组’为 **文本数组**  
> 变量‘y轴内容组’的结构如下  

>     数据类型名     公开                              备注 
>     Y轴数据类型   
>     成员名        类型              传址     数组    备注 
>     名称         文本型
>     类型         文本型                              可选：line/bar（折线图/柱形图） 
>     是否平滑曲线  逻辑型
>     数据组       文本型                       √




### 模块使用演示2(异步js加载数据)

* 三行代码生成空白折线图（数据用js后期动态加载）

> 
> 
>     .版本 2
>     .支持库 exui
>     
>     页面代码 ＝ 页面代码_生成 (#CSS_隐藏滚动条, 折线图_创建 (, , “test”, “aabbcc”, 配置内容, 真))  
>     
>     写到文件 (取运行目录 () ＋ “\demo.html”, 编码转换_Ansi到Utf8 (页面代码))
>     浏览框EX1.地址 ＝ 取运行目录 () ＋ “\demo.html”

> 注意上边的“折线图创建”的第4个参数：“aabbcc”为折线图对象的名称，后续使用js写入数据时要用到这个名称  
> 单页面多个折线图时此名称必须不能重名  
> 上边“折线图_创建”的最后一个参数置“真”时，将显示loading画面等待数据读入

* js加载数据的方法：  
1).创建option（使用随机数做演示），


>     .版本 2    
>     
>     .计次循环首 (12, 计数器)
>         加入成员 (X轴, 到文本 (计数器) ＋ “月”)
>         加入成员 (数据组1, 取随机数 (0, 100))
>         加入成员 (数据组2, 取随机数 (50, 150))
>     .计次循环尾 ()
>     
>     json.解析 (“{}”) ' 创建空json
>     json.置新值 (“title.text”, , “主标题”)  ' 设置图表主标题
>     json.置新值 (“title.subtext”, , “副标题”)  ' 设置图表副标题
>     
>     json.置新值 (“xAxis.data”, 创建JSON数组 (X轴))  ' 设置X轴内容，x轴为文本数组，此处使用创建JSON数组()将其转换为json支持的格式
>     
>     json.置新值 (“yAxis.type”, , “value”)  ' Y轴类型
>     
>     json.数组_加入成员 (“series”, “{}”)  ' 第一组折线
>     json.置新值 (“series[0].name”, , “数据组1”)  ' 折线名称
>     json.置新值 (“series[0].type”, , “line”)  ' 折线类型，更换为‘bar’就变成柱形图了
>     json.置新值 (“series[0].smooth”, , , , 真)  ' 是否平滑
>     json.置新值 (“series[0].data”, 创建JSON数组 (, , 数据组1))
>     json.置新值 (“series[0].areaStyle.normal”, “”)  ' 添加区域填充效果
>     
>     json.数组_加入成员 (“series”, “{}”)  ' 第二组折线
>     json.置新值 (“series[1].name”, , “数据组2”)  ' 同第一组
>     json.置新值 (“series[1].type”, , “line”)  ' 同第一组
>     json.置新值 (“series[1].smooth”, , , , 真)  ' 同第一组
>     json.置新值 (“series[1].data”, 创建JSON数组 (, , 数据组2))  ' 同第一组
>     
>     .计次循环首 (json.数组_取长度 (“series”), 计数器)
>         json.数组_加入成员 (“legend.data”, , json.取文本 (“series[” ＋ 到文本 (计数器 － 1) ＋ “].name”))  ' 从已有的数组'series'中读取name作为图例名称
>     .计次循环尾 ()
>     
>     json.置新值 (“tooltip.trigger”, , “axis”)  ' 标准折线图为“item"
>     
  
以上代码将会生成以下json代码：
```javascript
{
    "title": {
        "text": "主标题",
        "subtext": "副标题"
    },
    "xAxis": {
        "data": ["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]
    },
    "yAxis": {
        "type": "value"
    },
    "series": [
        {
            "name": "数据组1",
            "type": "line",
            "smooth": true,
            "data": [41,72,80,65,96,49,51,63,66,80,71,64],
            "areaStyle": {
                "normal": {}
            }
        },
        {
            "name": "数据组2",
            "type": "line",
            "smooth": true,
            "data": [135,88,119,118,72,117,111,137,74,133,110,102]
        }
    ],
    "legend": {
        "data": [
            "数据组1",
            "数据组2"
        ]
    },
    "tooltip": {
        "trigger": "axis"
    }
}
```

2).使用js将上边生成的option写入到echarts图表中并立即显示出来（可以随时使用setOption写入数据，echarts会自动更新并调整图表适配）

> 
>     .版本 2
>
>     执行JS代码 ( 浏览框1 , “aabbcc.hideLoading();” )  '模块内置命令调用浏览框1执行js代码，关闭loading动画
>     执行JS代码 ( 浏览框1 , “aabbcc.setOption(” ＋ json.取代码() ＋ “)” )  '模块内置命令调用浏览框1执行js代码，加载生成好的数据  

3).如需运行时即时更改图形中数据，无需重新生成整个图形，只需动态修改json配置中的数据，然后使用js加载到图形中，图形会自动即时更新显示。  

这里随机更改上边12个月份中某个月的数据为0-200的随机数  
>     .版本 2
>     json.置新值 (“series[0].data[” ＋ 到文本 (取随机数 (0, 11)) ＋ “]”, , , 取随机数 (0, 200))  

然后使用js动态加载数据（你没看错，和上边加载数据代码一样）
>     .版本 2
>     执行JS代码 ( 浏览框1 , “aabbcc.setOption(” ＋ json.取代码() ＋ “)” )  '模块内置命令调用浏览框1执行js代码，加载生成好的数据

### WKE说明
> 上边演示代码是使用超文本浏览框控件，但超文本浏览框是ie浏览器内核，性能有限，且问题比较多（比如虽然模块支持使用超文本浏览框运行js，但运行时会有‘哒’的一声音）  
> 这里建议使用wke浏览框模块（可以使用易语言论坛kyozy封装的wke1.3模块)  
> wke可以理解为精简版的chrome浏览器  
> 如需使用更复杂的图形则需要更强大的浏览框，比如封装了Chromium的CEF模块

WKE模块性能会更好一些，代码也很简单，示例如下（使用wke无需将生成的html保存为外部文件，可内存直接加载）：

1.wke浏览框初始化，并载入生成的图形  
>     .版本 2
>     wke.绑定 (_启动窗口.取窗口句柄 ()) ' 这里默认使用整个窗口做图形显示
>     json.解析 (标准配置_折线图 (“折线图主标题”, “折线图副标题”, X轴内容组, Y轴内容组))
>     wke.载入(页面代码_生成 (#CSS_隐藏滚动条, 创建图形 (“640px”, “480px”, , “myChart”, json.取代码 ())))  

2.wke浏览框使用运行js命令关闭loading动画并载入数据
>     .版本 2
>     wke.运行js(“aabbcc.hideLoading();)
>     wke.运行js(“aabbcc.setOption(” ＋ json.取代码() ＋ “)”)

### 文件列表
> 演示文件中因为需要演示js异步加载功能，所以使用了exui的wke浏览框控件，实际使用如果不需要js也可以使用易语言内置的超文本浏览框。

- **目录code** ----   为模块文本源码  
- **目录js**  ----  为引用的echart.js文件（只为展示，使用时不需要，js文件已内置到模块中）  
- **Echart_DEMO.e**  ----  为演示程序（演示程序使用了EXUI支持库的wke浏览框控件，需要单独下载）  
- **Echarts模块v---.ec**  ----  为已编译的成品模块文件  
- **READMO.md**  ----  说明文件
- **LICENSE**  ----  开源协议
- **echart.e**  ----  模块易语言源码文件
- **wke.dll**  ----  demo演示文件使用了EXUI支持库的wke浏览框控件
- **ex_ui2016.9.15.zip**  ----  EXUI支持库（demo演示文件中使用）